
// Just the code for the color bar.

/* List of choices:
0. Original
1. Standard
2. Copper
3. Roy G. Biv
4. Electric
5. Blank
6. Inv. Blank
*/

#include <stdio.h>
#include <stdlib.h>
#include <math.h>

void get_rgb( double val , float * rp , float * gp , float * bp , int COLORBAR, int flipCM ){

   if (flipCM) val = 1.0 - val;

   double rrr,ggg,bbb;
   double v5, v4, v3, v2;
   v2 = val*val;
   v3 = val*v2;
   v4 = v2*v2;
   v5 = v3*v2;

   if( COLORBAR == 0 ){
      // turbo (Google)
      double v6, v7, v8, v9, v10, v11, v12, v13, v14;
      v6 = v3*v3;
      v7 = v3*v4;
      v8 = v4*v4;
      v9 = v4*v5;
      v10 = v5*v5;
      v11 = v5*v6;
      v12 = v6*v6;
      v13 = v6*v7;
      v14 = v7*v7;

      rrr = 67218.44529800*v14 + -795140.22546455*v13 + 3623609.58132191*v12 + -9014868.96187022*v11 + 13993243.34083862*v10 + -14426829.64145401*v9 + 10159801.79599321*v8 + -4916974.93638128*v7 + 1616481.54849439*v6 + -350829.99412471*v5 + 47994.92042232*v4 + -3862.58206505*v3 + 158.60289779*v2 + -1.62378051*val + 0.20003792;
      ggg = -452834.96044262*v14 + 3151933.79449941*v13 + -9782266.64635108*v12 + 17851545.42315623*v11 + -21267617.94550422*v10 + 17364123.88381680*v9 + -9922178.74687311*v8 + 3980270.49795092*v7 + -1107413.51678722*v6 + 207745.04592889*v5 + -25034.06714020*v4 + 1790.85409366*v3 + -67.56760767*v2 + 3.89680081*val + 0.06587285;
      bbb = 960094.69268648*v14 + -6880765.78283919*v13 + 21979938.41545450*v12 + -41245783.72147611*v11 + 50446282.18607344*v10 + -42181476.69309566*v9 + 24605411.62129936*v8 + -10035683.21544954*v7 + 2825848.92792508*v6 + -534020.53174611*v5 + 64669.44653261*v4 + -4684.15698612*v3 + 164.16679135*v2 + 4.42426027*val + 0.23627597;
   }else if(COLORBAR == 1){
      if( val < .1 ){
         bbb = 4.*(val+.15);
         ggg = 0.0;
         rrr = 0.0;
      }else if( val < .35){
         bbb = 1.0;
         ggg = 4.*(val-.1);
         rrr = 0.0;
      }else if( val < .6 ){
         bbb = 4.*(.6-val);
         ggg = 1.;
         rrr = 4.*(val-.35);
      }else if( val < .85){
         bbb = 0.0;
         ggg = 4.*(.85-val);
         rrr = 1.;
      }else{
         bbb = 0.0;
         ggg = 0.0;
         rrr = 4.*(1.1-val);
      }
   }else if(COLORBAR == 2){
      rrr = 2.*val;
      ggg = 1.2*val;
      bbb = .8*val;
   }else if(COLORBAR == 3){
      double gam = .8;
      double Amp;
      double r0,g0,b0;
      double hi,lo,x1,x2,x3,x4;
      hi = .8;
      lo = .1;
      if( val > hi ) Amp = .3 + .7*(1.-val)/(1.-hi);
      else if( val < lo ) Amp = .3 + .7*(val)/(lo);
      else Amp = 1.0;

      x1 = .5;
      x2 = .325;
      x3 = .15;
      x4 = 0.;

      if( val > x1 )      r0 = 1.;
      else if( val > x2 ) r0 = (val-x2)/(x1-x2);
      else if( val > x3 ) r0 = 0.;
      else if( val > x4 ) r0 = (val-x3)/(x4-x3);
      else                r0 = 1.;

      x1 = .6625;
      x2 = .5;
      x3 = .275;
      x4 = .15;

      if( val > x1 )      g0 = 0.;
      else if( val > x2 ) g0 = (val-x1)/(x2-x1);
      else if( val > x3 ) g0 = 1.;
      else if( val > x4 ) g0 = (val-x4)/(x3-x4);
      else                g0 = 0.;

      x1 = .325;
      x2 = .275;

      if( val > x1 )      b0 = 0.;
      else if( val > x2 ) b0 = (val-x1)/(x2-x1);
      else                b0 = 1.;

      rrr = pow(Amp*r0,gam);
      ggg = pow(Amp*g0,gam);
      bbb = pow(Amp*b0,gam);
      
      //if( val > .99 ){ rrr = 1.0; ggg = 1.0 ; bbb = 1.0; }
      //if( val < .01 ){ rrr = 0.0; ggg = 0.0 ; bbb = 0.0; }

   }else if(COLORBAR == 4){
      if( val < .1 ){
         bbb = 4.*(val+.125);
         ggg = 0.0;
         rrr = 0.0;
      }else if( val < .375){
         bbb = 1.0;
         ggg = 4.*(val-.125);
         rrr = 0.0;
      }else if( val < .625 ){
         bbb = 4.*(.625-val);
         rrr = 4.*(val-.375);
         ggg = bbb;
         if( rrr > bbb ) ggg = rrr;
      }else if( val < .875){
         bbb = 0.0;
         ggg = 4.*(.875-val);
         rrr = 1.;
      }else{
         bbb = 0.0;
         ggg = 0.0;
         rrr = 4.*(1.125-val);
      }
   }else if(COLORBAR == 5){
      rrr = val;
      ggg = val;
      bbb = val;
   }else if(COLORBAR == 6){
      // magma (matplotlib)
      rrr = 5.2687848*v5 - 11.44778744*v4  + 6.13567269*v3 -0.01964937*v2 + 1.0698287*val -0.02223323;
      ggg = -5.54509553*v5 + 11.4659551*v4 - 6.76338190*v3 + 1.63850072*v2 + 0.178140470*val + .0105032349;
      bbb = -12.8819794*v5 + 32.9740674*v4 -24.7317822*v3 + 3.19023254*v2 + 2.21260079*val -0.00661976479;
   }else if(COLORBAR == 7){
      // inferno (matplotlib)
      double v6, v7, v8, v9;
      v6 = v3*v3;
      v7 = v3*v4;
      v8 = v4*v4;
      v9 = v4*v5;

      rrr = 353.03327105*v9 + -1470.88275954*v8 + 2518.04284713*v7 + -2253.31553816*v6 + 1093.49189644*v5 + -254.27368291*v4 + 5.51981471*v3 + 9.33740110*v2 + 0.03763654*val + 0.00228385;
      ggg = -558.70563289*v9 + 2429.27311490*v8 + -4344.49539941*v7 + 4094.43416755*v6 + -2155.38216084*v5 + 609.75414705*v4 + -74.45594078*v3 + -0.22560533*v2 + 0.80290083*val + -0.00815033;
      bbb = 434.51062082*v9 + -1934.52177132*v8 + 3379.24756989*v7 + -2881.66653015*v6 + 1156.34385196*v5 + -99.43855605*v4 + -70.96109647*v3 + 15.80548478*v2 + 1.31196143*val + 0.01188670;
   }else if(COLORBAR == 8){
      // viridis (matplotlib)
      rrr = -11.80729026*v5 + 25.27758373*v4 -14.85075402*v3  + 2.2290938*v2 -0.14187082*val + 0.2800557;
      ggg = 0.121926730*v5 -1.52661275*v4 + 2.53827574*v3 -1.83476402*v2 + 1.60267540*val -0.00126998147;
      bbb = 13.69761657*v5 -33.28507238*v4 +  28.69652089*v3 -11.89994842*v2 + 2.58966906*val + 0.30238385;
   }else if(COLORBAR == 9){
      // fearless idea
      double v6, v7, v8, v9, v10, v11, v12, v13, v14;
      v6 = v3*v3;
      v7 = v3*v4;
      v8 = v4*v4;
      v9 = v4*v5;
      v10 = v5*v5;
      v11 = v5*v6;
      v12 = v6*v6;
      v13 = v6*v7;
      v14 = v7*v7;

      rrr = -339052.58765971*v14 + 2378322.62792338*v13 + -7431459.27726085*v12 + 13634285.65033955*v11 + -16299573.61354742*v10 + 13323480.04072026*v9 + -7603567.35982416*v8 + 3039969.93747006*v7 + -842381.67114325*v6 + 157760.12200660*v5 + -19136.60729466*v4 + 1408.55471235*v3 + -58.53606105*v2 + 3.68703562*val + 0.02679899;
      ggg = 345834.18942290*v14 + -2407536.68231237*v13 + 7466528.29046747*v12 + -13600398.02064648*v11 + 16151959.61619647*v10 + -13128280.10495173*v9 + 7460077.94108592*v8 + -2975253.51067690*v7 + 824368.35915176*v6 + -154913.79382242*v5 + 18987.96057112*v4 + -1432.63857532*v3 + 59.88173696*v2 + -0.49050263*val + 0.00621574;
      bbb = 977692.24248626*v14 + -6885588.27955981*v13 + 21614867.99947388*v12 + -39865230.47268245*v11 + 47936542.22890460*v10 + -39427057.65051076*v9 + 22638900.00981719*v8 + -9099458.94097637*v7 + 2529745.39770873*v6 + -473416.11286858*v5 + 56927.12796437*v4 + -4066.73266942*v3 + 144.67519126*v2 + -0.52597951*val + 0.02192712;
   }else if(COLORBAR == 10){
      // Red-Blue (cmocean 'balance')
      double v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v16;
      v6 = v3*v3;
      v7 = v3*v4;
      v8 = v4*v4;
      v9 = v4*v5;
      v10 = v5*v5;
      v11 = v5*v6;
      v12 = v6*v6;
      v13 = v6*v7;
      v14 = v7*v7;
      v15 = v8*v7;
      v16 = v8*v8;

      rrr = 6286208.53816793*v16 + -45547996.63837198*v15 + 144955283.99165604*v14 + -263363765.80589831*v13 + 293804267.03586644*v12 + -193438855.06465584*v11 + 49334521.32956106*v10 + 33698515.36963761*v9 + -41966184.92851751*v8 + 21902364.53772504*v7 + -6868680.69925508*v6 + 1358323.84921036*v5 + -165051.43624854*v4 + 11447.72218307*v3 + -404.33759140*v2 + 6.70426783*val + 0.07521113;
      ggg = 12440583.07178389*v16 + -100228666.38931328*v15 + 365461322.12377787*v14 + -797349985.93185639*v13 + 1159621494.77054715*v12 + -1185566120.89457178*v11 + 875801300.07721472*v10 + -473283271.85155302*v9 + 187407188.97046643*v8 + -53970504.31797707*v7 + 11114638.75720841*v6 + -1590304.35447493*v5 + 150813.64901119*v4 + -8758.26907390*v3 + 272.74670714*v2 + -2.23365134*val + 0.12047985;
      bbb = 23494764.45998017*v16 + -189345758.81833124*v15 + 690527079.87806022*v14 + -1506664923.36919689*v13 + 2190990318.38864326*v12 + -2238931380.12575293*v11 + 1651672176.30293894*v10 + -889623347.02268612*v9 + 349753527.49732482*v8 + -99280001.21819477*v7 + 19892171.69187684*v6 + -2709553.13164837*v5 + 236841.97827676*v4 + -12251.93622946*v3 + 336.08376497*v2 + -0.84940018*val + 0.26785311;

    }else if(COLORBAR == 11){
      // Purple and green
      double v6, v7;
      v6 = v3*v3;
      v7 = v3*v4;

      rrr = -3.15151489*v7 + -26.44357655*v6 + 111.55029200*v5 + -141.32019992*v4 + 72.90100974*v3 + -17.05941751*v2 + 3.29985392*val + 0.23189982;
      ggg = -37.98507357*v7 + 129.97007419*v6 + -174.03829563*v5 + 121.99570095*v4 + -53.84964418*v3 + 13.33984287*v2 + 0.82045038*val + 0.00567647;
      bbb = -51.85314990*v7 + 134.68646793*v6 + -103.62306658*v5 + 6.59218715*v4 + 19.59112571*v3 + -8.49746250*v2 + 2.91776116*val + 0.27960782;
    }else if(COLORBAR == 12){
      // guppy (cmasher)
      double v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v16;
      v6 = v3*v3;
      v7 = v3*v4;
      v8 = v4*v4;
      v9 = v4*v5;
      v10 = v5*v5;
      v11 = v5*v6;
      v12 = v6*v6;
      v13 = v6*v7;
      v14 = v7*v7;
      v15 = v8*v7;
      v16 = v8*v8;
      rrr = -3067126.76643379*v16 + 24622265.32095284*v15 + -89130771.20926264*v14 + 192111082.30937585*v13 + -274231885.87663841*v12 + 272862341.91015255*v11 + -194043533.95972201*v10 + 99569842.14994080*v9 + -36824538.56354333*v8 + 9729299.12794232*v7 + -1812106.18203382*v6 + 234861.70701486*v5 + -20901.49563911*v4 + 1211.35649828*v3 + -41.58660470*v2 + 0.89438120*val + 0.97956401;
      ggg = -10517082.38583856*v16 + 87047807.62181015*v15 + -327972736.26700097*v14 + 744503202.70641804*v13 + -1135679129.24779272*v12 + 1229154966.20802569*v11 + -971224679.51213253*v10 + 567653291.42150569*v9 + -245815936.73267964*v8 + 78172870.50701274*v7 + -17885403.19253988*v6 + 2840803.15527263*v5 + -295906.17727198*v4 + 18541.37601298*v3 + -615.38858502*v2 + 6.15936034*val + 0.54293898;
      bbb = -5573898.85812062*v16 + 45771900.73080226*v15 + -169801863.96895686*v14 + 375802465.22953385*v13 + -551868892.74845827*v12 + 565692810.97862196*v11 + -414440291.11071002*v10 + 218360544.76585907*v9 + -82018304.06856446*v8 + 21391756.45539873*v7 + -3668346.69348824*v6 + 367048.48543912*v5 + -14468.98035416*v4 + -515.55162327*v3 + 59.31573513*v2 + -3.54972488*val + 0.31618151;
   }else{
      rrr = 1.0;
      ggg = 1.0;
      bbb = 1.0;
   }
   if (rrr < 0.0) rrr = 0.0;
   if (rrr > 1.0) rrr = 1.0;
   if (ggg < 0.0) ggg = 0.0;
   if (ggg > 1.0) ggg = 1.0;
   if (bbb < 0.0) bbb = 0.0;
   if (bbb > 1.0) bbb = 1.0;

   *rp = rrr;
   *gp = ggg;
   *bp = bbb;

}
